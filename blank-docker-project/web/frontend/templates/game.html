<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    {% load static%}
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>

<body>

    <!--library for make request HTTP-->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        const getRequest = async () => {
            const response = await axios.get('/frontend/sendframe', {
                params: {
                    "test": "this is a test",
                }
            },
            )
            console.log(response.data)

        }
        getRequest();
    </script>

    <!-- Load TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <!-- Load Posenet <script src="https://unpkg.com/@tensorflow-models/posenet"></script>-->
    <!--Load WebcamEasy-->
    <script type="text/javascript" src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>
    <!--Load Utils-->
    <script type="module" src="{% static 'utils.js' %}"></script>

    <h1>Game</h1>
    <!--<img src="{% static 'assets/logo.png' %}">-->
    <div id="Container">
        <video autoplay="true" id="videoElement" width="640" height="480"></video>
        <canvas id="myCanvas" width="640" height="480"></canvas>
        <label>Score</label><label style="font-size:40px;" id="score"></label>
        <img id="paint" height="480" src="{% static 'assets/opere/sangiovanni.jpeg' %}">
        <canvas id="myCanvasp" width="366" height="480"></canvas>
    </div>

    <script type="module">
        import { poseInit, runPosenet } from "{% static 'game.js' %}"
        var scoreLbl = document.getElementById('score');
        const paintElement = document.getElementById('paint');
        const canvasElementp = document.getElementById('myCanvasp')
        canvasElementp.style.width = paintElement.clientWidth;
        canvasElementp.style.height = paintElement.clientHeight;
        const webcamElement = document.getElementById('videoElement');
        const canvasElement = document.getElementById('myCanvas');
        const webcam = new Webcam(webcamElement, 'user', canvasElement);
        await webcam.start();

        fetch("http://127.0.0.1:8080")
            .then(response => {
                console.log(response);
            })
            .catch(error => console.log("Si Ã¨ verificato un errore!"))

        poseInit(webcamElement, paintElement, canvasElement, canvasElementp, scoreLbl);
    </script>
</body>

</html>